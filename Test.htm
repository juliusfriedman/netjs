<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Javascript Generic List Implementation</title>

    <script type="text/javascript" src="GenericList.js"></script>
    <script type="text/javascript" src="Cast.js"></script>
    <script type="text/javascript" src="Reflection.js"></script>

    <script type="text/javascript">

        function Car(make, model)
        {
            this.make = make;
            this.model = model;
        }

        function init()
        {
            try
            {
                var myList = new List();
                myList.Add(new Car("Honda", "Civic"));
                myList.Add(new Car("Nissan", "Sentra"));
                myList.Add(new Car("Honda", "Cr-V"));
                myList.Add(new Car("Honda", "Cr-V"));

                debugger;

                Reflection.getArguments(myList.Add);

                //This will retrieve the 0th member from the List
                var testGetter = myList[0]; // Car{make:'Honda',model:'Civic'}

                try {
                    //This will produce an exception
                    var testGetterException = myList[9];
                }
                catch (e) {                    
                    //e = "index parameter out of range in List.Get"
                }

                var selList = myList.Where("make == 'Honda'").OrderByDescending("model").Distinct(); //2 in Count
                var anotherList = myList.Where(function () { return this.make == 'Honda' }).OrderByDescending("model").Distinct(); //2 in Count
                var yetAnotherList = myList.Where(function (c) { return c.make == 'Honda' }).OrderByDescending("model").Distinct(); //2 in Count
                var finalList = myList.Where(function () { return make == 'Honda' }).OrderByDescending("model").Distinct(); //0 in Count because make is not quantified

                if (selList.Count() !== 2 || anotherList.Count() !== 2 || yetAnotherList.Count() !== 2 || finalList.Count() !== 0) alert('Bug');

                var outputString = '';
                for (var index = 0; index < selList.Count(); index++)
                    outputString += selList.ElementAt(index).model + '\r\n';

                var outputElement = document.getElementById('output');
                if (outputElement)
                    outputElement.innerText = outputString;
            }
            catch(ex)
            {
                alert('The following error occurred: ' + ex);
            }
        }
    
    </script>

</head>
<body onload="init()">
    <h1 id="output" runat="server" />
</body>
</html>
